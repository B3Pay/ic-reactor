/* eslint-disable */
// @ts-nocheck

/**
 * AUTO-GENERATED BY @ic-reactor/vite-plugin
 * DO NOT EDIT MANUALLY
 *
 * Canister: backend
 * Generated: 2026-01-09T08:01:39.510Z
 *
 * This file provides type-safe React hooks for interacting with the
 * backend canister using ic-reactor.
 */

import { QueryClient } from "@tanstack/react-query"
import {
  ClientManager,
  DisplayReactor,
  createQuery,
  createQueryFactory,
  createMutation,
  createSuspenseQuery,
  createAuthHooks,
} from "@ic-reactor/react"
import { safeGetCanisterEnv } from "@icp-sdk/core/agent/canister-env"
import {
  idlFactory,
  type _SERVICE,
} from "./declarations/declarations/backend.did"

// ═══════════════════════════════════════════════════════════════════════════
// CANISTER ENVIRONMENT
// ═══════════════════════════════════════════════════════════════════════════

interface BackendCanisterEnv {
  readonly "PUBLIC_CANISTER_ID:backend": string
}

/**
 * Get canister ID from runtime environment (ic_env cookie)
 * Falls back to a placeholder in development
 */
function getBackendCanisterId(): string {
  const env = safeGetCanisterEnv<BackendCanisterEnv>()

  if (env?.["PUBLIC_CANISTER_ID:backend"]) {
    return env["PUBLIC_CANISTER_ID:backend"]
  }

  console.warn("[ic-reactor] backend canister ID not found in ic_env cookie")
  return "aaaaa-aa" // Fallback
}

// ═══════════════════════════════════════════════════════════════════════════
// GLOBAL CLIENT MANAGER (Singleton)
// ═══════════════════════════════════════════════════════════════════════════

let _queryClient: QueryClient | null = null
let _clientManager: ClientManager | null = null

function getQueryClient(): QueryClient {
  if (!_queryClient) {
    _queryClient = new QueryClient({
      defaultOptions: {
        queries: {
          staleTime: 1000 * 60,
          gcTime: 1000 * 60 * 5,
          retry: 1,
          refetchOnWindowFocus: false,
        },
      },
    })
  }
  return _queryClient
}

function getClientManager(): ClientManager {
  if (!_clientManager) {
    const env = safeGetCanisterEnv()
    _clientManager = new ClientManager({
      queryClient: getQueryClient(),
      agentOptions: {
        host:
          typeof window !== "undefined" ? window.location.origin : undefined,
        rootKey: env?.IC_ROOT_KEY,
        verifyQuerySignatures: false,
      },
    })
    _clientManager.initialize().catch(console.error)
  }
  return _clientManager
}

// ═══════════════════════════════════════════════════════════════════════════
// EXPORTS: Query Client & Client Manager
// ═══════════════════════════════════════════════════════════════════════════

export const queryClient = getQueryClient()
export const clientManager = getClientManager()

// ═══════════════════════════════════════════════════════════════════════════
// AUTH HOOKS
// ═══════════════════════════════════════════════════════════════════════════

export const { useAuth, useAgentState, useUserPrincipal } =
  createAuthHooks(clientManager)

// ═══════════════════════════════════════════════════════════════════════════
// REACTOR INSTANCE
// ═══════════════════════════════════════════════════════════════════════════

/**
 * Backend Reactor with Display type transformations.
 * Automatically converts bigint → string, Principal → string, etc.
 */
export const backendReactor = new DisplayReactor<_SERVICE>({
  clientManager,
  canisterId: getBackendCanisterId(),
  idlFactory,
  name: "backend",
})

// ═══════════════════════════════════════════════════════════════════════════
// QUERY HOOKS
// ═══════════════════════════════════════════════════════════════════════════

/**
 * Query: get_counter
 * No arguments
 * Returns: IDL.Nat
 */
export const getCounterQuery = createQuery(backendReactor, {
  functionName: "get_counter",
})
export const useGetCounter = getCounterQuery.useQuery
export const useGetCounterSuspense = createSuspenseQuery(backendReactor, {
  functionName: "get_counter",
}).useSuspenseQuery

/**
 * Query: get_message
 * No arguments
 * Returns: IDL.Opt(IDL.Text)
 */
export const getMessageQuery = createQuery(backendReactor, {
  functionName: "get_message",
})
export const useGetMessage = getMessageQuery.useQuery
export const useGetMessageSuspense = createSuspenseQuery(backendReactor, {
  functionName: "get_message",
}).useSuspenseQuery

/**
 * Query: greet
 * Args: (IDL.Text)
 * Returns: IDL.Text
 */
export const greetQuery = createQueryFactory(backendReactor, {
  functionName: "greet",
})
// Usage: greetQuery([arg1, arg2]).useQuery() or useGreet({ args: [arg1] })
export const useGreet = (
  options: { args: Parameters<_SERVICE["greet"]> } & Record<string, unknown> = {
    args: [] as any,
  }
) => greetQuery(options.args).useQuery(options)

// ═══════════════════════════════════════════════════════════════════════════
// MUTATION HOOKS
// ═══════════════════════════════════════════════════════════════════════════

/**
 * Mutation: increment
 * No arguments
 * Returns: IDL.Nat
 */
export const incrementMutation = createMutation(backendReactor, {
  functionName: "increment",
})
export const useIncrement = incrementMutation.useMutation

/**
 * Mutation: set_message
 * Args: (IDL.Text)
 * Returns: void
 */
export const setMessageMutation = createMutation(backendReactor, {
  functionName: "set_message",
  invalidateQueries: [getMessageQuery.getQueryKey()],
})
export const useSetMessage = setMessageMutation.useMutation

// ═══════════════════════════════════════════════════════════════════════════
// RE-EXPORTS
// ═══════════════════════════════════════════════════════════════════════════

export { idlFactory }
export type { _SERVICE as BackendService }
export { backendReactor as reactor }
