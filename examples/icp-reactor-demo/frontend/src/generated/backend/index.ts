/**
 * AUTO-GENERATED BY @ic-reactor/vite-plugin
 *
 * Canister: backend
 * Generated: 2026-01-09T09:18:15.129Z
 *
 * This file provides type-safe React hooks for interacting with the
 * backend canister using ic-reactor.
 */

import { DisplayReactor, createActorHooks } from "@ic-reactor/react"
import { safeGetCanisterEnv } from "@icp-sdk/core/agent/canister-env"

// ═══════════════════════════════════════════════════════════════════════════
// USER-PROVIDED CLIENT MANAGER
// ═══════════════════════════════════════════════════════════════════════════
// The clientManager is imported from the user's own configuration file.
// This allows full customization of agent options, network settings, etc.
import { clientManager } from "../../lib/client"

// Import generated declarations from @icp-sdk/bindgen
import {
  idlFactory,
  type _SERVICE,
} from "./declarations/declarations/backend.did"

// ═══════════════════════════════════════════════════════════════════════════
// CANISTER ID RESOLUTION
// ═══════════════════════════════════════════════════════════════════════════

interface BackendCanisterEnv {
  readonly "PUBLIC_CANISTER_ID:backend": string
}

/**
 * Get canister ID from runtime environment (ic_env cookie)
 * Falls back to a placeholder in development
 */
function getBackendCanisterId(): string {
  const env = safeGetCanisterEnv<BackendCanisterEnv>()

  if (env?.["PUBLIC_CANISTER_ID:backend"]) {
    return env["PUBLIC_CANISTER_ID:backend"]
  }

  console.warn("[ic-reactor] backend canister ID not found in ic_env cookie")
  return "aaaaa-aa" // Fallback
}

// ═══════════════════════════════════════════════════════════════════════════
// REACTOR INSTANCE
// ═══════════════════════════════════════════════════════════════════════════

/**
 * Backend Reactor with Display type transformations.
 * Automatically converts bigint → string, Principal → string, etc.
 */
export const backendReactor = new DisplayReactor<_SERVICE>({
  clientManager,
  canisterId: getBackendCanisterId(),
  idlFactory,
  name: "backend",
})

// ═══════════════════════════════════════════════════════════════════════════
// HOOKS
// ═══════════════════════════════════════════════════════════════════════════

/**
 * React hooks for the backend canister.
 */
const {
  useActorQuery: useBackendQuery,
  useActorSuspenseQuery: useBackendSuspenseQuery,
  useActorInfiniteQuery: useBackendInfiniteQuery,
  useActorSuspenseInfiniteQuery: useBackendSuspenseInfiniteQuery,
  useActorMutation: useBackendMutation,
  useActorMethod: useBackendMethod,
} = createActorHooks(backendReactor)

export {
  useBackendQuery,
  useBackendSuspenseQuery,
  useBackendInfiniteQuery,
  useBackendSuspenseInfiniteQuery,
  useBackendMutation,
  useBackendMethod,
}

// ═══════════════════════════════════════════════════════════════════════════
// RE-EXPORTS
// ═══════════════════════════════════════════════════════════════════════════

export { idlFactory }
export type { _SERVICE as BackendService }
